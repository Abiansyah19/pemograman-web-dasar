<style>
  #kodeb option:first-child{
    display: none;
  }
  .kar option:first-child{
    display: none;
  }
  .jab option:first-child{
    display: none;
  }
</style>

<button type="button" class="insert btn btn-warning" data-bs-toggle="modal" data-bs-target="#myModal">
  +
 </button>
 <br>
 <h1>penjualan</h1>
<!-- The Modal -->
<div class="modal" id="myModal">
  <div class="modal-dialog">
  <div class="modal-content">
  <!-- Modal Header -->
  <div class="modal-header">
  <h1 class="modal-title">Input</h1>
  <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
  </div>

  <!-- Modal body -->
  <div class="modal-body">
 <div class="mb-3 mt-3">
  <label class="form-label">Kode Barang:</label>
 <select name="kode" id="kodeb" class="form-select">
         <option value="" selected></option>
         <option value="m001">m001</option>
         <option value="m002">m002</option>
         <option value="m003">m003</option>
       </select>
 <label class="form-label">Nama:</label>
 <input type="text" name="nama" id="nama" class="form-control" /* tambahkan lg untuk besar dan sm untuk kecil inputan*/>
 <label class="form-label">Satuan:</label>
 <input type="text" name="satuan" id="satuan" class="form-control" /* tambahkan lg untuk besar dan sm untuk kecil inputan*/>
 <label class="form-label">Harga:</label>
 <input type="text" name="harga" id="harga" class="form-control" /* tambahkan lg untuk besar dan sm untuk kecil inputan*/>
 <label class="form-label">Jumlah:</label>
 <input type="text" name="jumlah" id="jumlah" class="form-control" /* tambahkan lg untuk besar dan sm untuk kecil inputan*/>
 <br>
     <button type="button" class="btn btn-warning btn" id="save">save</button>
     <button type="button" class="btn btn-warning btn" id="update">update</button>
  </div>
 
  </div>
  <!-- Modal footer -->
  <div class="modal-footer">
  <button type="button" class="btn btn-warning" data-bs-dismiss="modal">Close</button>
  </div>
  </div>
  </div>
 </div>

      <label for="Kode" class="form-label">Kode</label><br />
      <input
        type="text"
        id="kode"
        name="kode"
        class="kode form-control"
        readonly
      /><br /><br />
      <label for="tgl" class="form-label">Tanggal</label><br />
      <input type="text" id="tgl" name="tgl" class="form-control" readonly /><br /><br />
      <label for="Konsumen" class="form-label">Konsumen</label><br />
      <input
        type="text"
        id="Konsumen"
        name="Konsumen"
        class="Konsumen form-control"
      /><br /><br />
      <label for="Karyawan" class="form-label">Karyawan</label><br />
      <select name="Karyawan" id="Karyawan" class="kar form-select" onchange="ubah()">
        <option value=""></option>
        <option value="ani">ani</option>
        <option value="budi">budi</option>
        <option value="cindi">cindi</option></select
      ><br /><br />
      <label for="Jabatan" class="form-label">Jabatan</label><br />
      <select name="Jabatan" id="Jabatan" class="jab form-select">
        <option value=""></option>
        <option value="admin">admin</option>
        <option value="supervisor">supervisor</option>
        <option value="operator">operator</option></select
      ><br /><br />
      <table class="table" border="0">
        <thead>
          <tr>
            <td>Kodebrg</td>
            <td>Nama</td>
            <td>Satuan</td>
            <td>Harga</td>
            <td>Jumlah</td>
          </tr>
          <tr>
            <td>
              <select name="kodebrg" id="kodeb" onchange="ganti()">
                <option value=""></option>
                <option value="m001">m001</option>
                <option value="m002">m002</option>
                <option value="m003">m003</option>
              </select>
            </td>
            <td><input type="text" id="nama" name="nama" /></td>
            <td><input type="text" id="satuan" name="satuan" /></td>
            <td><input type="text" id="harga" name="harga" /></td>
            <td><input type="text" id="jumlah" name="jumlah" /></td>
          </tr>
          <tr></tr>
          <tr>
            <td><button type="button" id="save" class="save btn btn-warning">save</button></td>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <br /><br />
      <table id="mytable" class="table1 table" border="1">
        <thead>
          <th>kode</th>
          <th>nama</th>
          <th>satuan</th>
          <th>harga</th>
          <th>jumlah</th>
          <th>total</th>
          <th>action</th>
        </thead>
        <tbody id="tbody">

        </tbody>
      </table>
      <br /><br />
      <label for="" class="form-label">Total :</label><label for="" id="total" class="form-label">0</label>
      <br /><br />
  <!-- The Modal -->
<div class="modal" id="myModal2">
  <div class="modal-dialog">
  <div class="modal-content">
  <!-- Modal Header -->
  <div class="modal-header">
  <h4 class="modal-title">WARING</h4>
  <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
  </div>
  <!-- Modal body -->
  <div class="modal-body">
  <label class="form-label">Apakah anda yakin ?</label>
  <br>
  <button type="button" class="remova btn btn-warning" id="yes" data-bs-dismiss="modal">Yes</button>
  <button type="button" class="btn btn-warning" data-bs-dismiss="modal">No</button>
  </div>
  <!-- Modal footer -->
  <div class="modal-footer">
  <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
  </div>
  </div>
  </div>
 </div>
    <script>
      //ganti karyawan dan jabatan//
      function ubah() {
        if (document.getElementById("Karyawan").value == "ani") {
          document.getElementById("Jabatan").innerHTML =
            '<option value="1">admin</option><option value="2">Admin</option>';
        } else if (document.getElementById("Karyawan").value == "budi") {
          document.getElementById("Jabatan").innerHTML =
            '<option value="1">supervisor</option><option value="2">Supervisor</option>';
        } else if (document.getElementById("Karyawan").value == "cindi") {
          document.getElementById("Jabatan").innerHTML =
            '<option value="1">operator</option><option value="2">Operator</option>';
        }
      }
      //klik kodebrg semua muncul//
      $("#kodeb").change(function(){
      console.log("hello");
      if($("#kodeb").val()=="m001"){
        $("#nama").val("cpu");
        $("#satuan").val("pcs");
        $("#harga").val("200");
      }else if($("#kodeb").val()=="m002"){
        $("#nama").val("vga");
        $("#satuan").val("pcs");
        $("#harga").val("400");
      }else if($("#kodeb").val()=="m003"){
        $("#nama").val("ram");
        $("#satuan").val("pcs");
        $("#harga").val("300");
      } 
    });
      //ngambil tanggal//
      $(document).ready(function(){
    var total=0;
    //ambil tanngal//
    var date = new Date();
    var year = date.getFullYear();
    var month = date.getMonth() + 1;
    var day = date.getDate();
    var hour = date.getHours();
    var minute = date.getMinutes();
    var second = date.getSeconds();
    //var kode dan tanggal//
    $('#kode').val(year+""+month+""+day+""+hour+""+minute+""+second);
    $('#tgl').val(day+"-"+month+"-"+year);
    console.log(day);
    

      $(".insert").click(function(){
  $("#save").show();
	$("#update").hide();
});
    $("#save").click(function(){
      total = 0;
      var panjang = $('tbody tr').length;
      var kode = $('#kodeb').val();
      var nama = $('#nama').val();
      var satuan = $('#satuan').val();
      var harga =$('#harga').val();
      var jumlah = $('#jumlah').val();
      var totalhrg = harga*jumlah;
      $('#tbody').append("<tr><td>"+kode+"</td><td>"+nama+"</td><td>"+satuan+"</td><td>"+harga+"</td><td>"+jumlah+"</td><td>"+totalhrg+"</td><td><button type=\"button\" id=\"id1"+panjang+"\" class = \"update btn btn-warning\" data-bs-toggle = \"modal\" data-bs-target=\"#myModal\" >u</td><td><button type=\"button\" id=\"id"+panjang+"\" class = \"remove btn btn-warning\" data-bs-toggle = \"modal\" data-bs-target=\"#myModal2\" >x</td></tr>")
        console.log(panjang);
      $('#tbody tr').each(function(){
        var currentRow=$(this);
        total=total + Number(currentRow.find("td:eq(5)").text());
      });
      $("#total").text(total);
      
    });

    $(document).ready(function(){
      $.fn.updateBarang();
      $.fn.removeFunc();
    });

  var indexUpdate;
  const myModal = $("#myModal");
  $.fn.updateBarang = function () {
					let el;
					let elRow;
					let elKode;
					let elNama;
					let elGol;
					let elSat;
					let elHrg;
          let eltotalhrg;
          

					$("#mytable tbody").on("click",".update",function (){
            
						console.log("hello");
            myModal.find("h1").text("Update Barang");
						$("#save").hide();
						$("#update").show();
						indexUpdate = $(this).closest("tr").index();
						// console.log(indexUpdate);

						// cari tr
						console.log(indexUpdate);
						el = $("#mytable tbody").find("tr").eq(indexUpdate);
						// console.log(el);
						elRow = el.find("td");
						// console.log(elRow);

						// ambil semua value dari cell
						const kodeb = elRow[0].innerHTML;
						const nama = elRow[1].innerHTML;
						const satuan = elRow[2].innerHTML;
						const harga = elRow[3].innerHTML;
						const jumlah = elRow[4].innerHTML;
            const totalhrg = elRow[5].innerHTML;
            

						// ambil modal
						const modal = $("#myModal");

						// cari dan setting value dari form
						elKode = modal.find("#kodeb");
						elNama = modal.find("#nama");
						elGol = modal.find("#satuan");
						elSat = modal.find("#harga");
						elHrg = modal.find("#jumlah");
            


            //nilai masuk
						elKode.val(kodeb);
						elNama.val(nama);
						elGol.val(satuan);
						elSat.val(harga);
						elHrg.val(jumlah);
            
            
					});

					$("#update").click(function () {
						elRow[0].innerHTML = elKode.val();
						elRow[1].innerHTML = elNama.val();
						elRow[2].innerHTML = elGol.val();
						elRow[3].innerHTML = elSat.val();
						elRow[4].innerHTML = elHrg.val();
            eltotalhrg = elSat.val()*elHrg.val();
            elRow[5].innerHTML = eltotalhrg;
            
            console.log(elKode.val());
            console.log(eltotalhrg);
            

					});
				};
        $.fn.removeFunc = function () {
					$("#mytable tbody").on("click", ".remove", function () {
						indexUpdate = $(this).closest("tr").index();
						console.log(indexUpdate);
					});
					$(".remova").click(function () {
						$("#mytable tbody").find("tr").eq(indexUpdate).remove();
					});
				};
      });
    </script>


